<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WMS — Login</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0d0f0e; --surface: #151918; --border: #232b27;
    --accent: #c8f060; --text: #e8ede9; --muted: #6b7b70; --danger: #f06060;
  }

  body {
    background: var(--bg); color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh; display: grid; place-items: center; overflow: hidden;
  }

  body::before {
    content: ''; position: fixed; inset: 0;
    background-image:
      linear-gradient(rgba(200,240,96,0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(200,240,96,0.04) 1px, transparent 1px);
    background-size: 48px 48px; pointer-events: none;
  }

  body::after {
    content: ''; position: fixed; top: 50%; left: 50%;
    transform: translate(-50%,-50%); width: 600px; height: 600px;
    background: radial-gradient(ellipse, rgba(200,240,96,0.07) 0%, transparent 70%);
    pointer-events: none;
  }

  .wrap { position: relative; z-index: 1; width: 100%; max-width: 400px; padding: 20px; animation: fadeUp 0.6s ease both; }

  @keyframes fadeUp { from { opacity:0; transform:translateY(24px); } to { opacity:1; transform:translateY(0); } }

  .brand { margin-bottom: 40px; }
  .brand-label { font-family:'DM Mono',monospace; font-size:11px; color:var(--accent); letter-spacing:.25em; text-transform:uppercase; margin-bottom:8px; }
  .brand-name  { font-family:'Bebas Neue',sans-serif; font-size:56px; line-height:1; letter-spacing:.04em; }
  .brand-name span { color: var(--accent); }

  .card { background:var(--surface); border:1px solid var(--border); border-radius:4px; padding:36px; position:relative; }
  .card::before { content:''; position:absolute; top:0;left:0;right:0;height:2px; background:var(--accent); border-radius:4px 4px 0 0; }

  .card-title { font-family:'DM Mono',monospace; font-size:11px; color:var(--muted); letter-spacing:.2em; text-transform:uppercase; margin-bottom:28px; }

  .field { margin-bottom: 20px; }
  .field label { display:block; font-family:'DM Mono',monospace; font-size:10px; color:var(--muted); letter-spacing:.18em; text-transform:uppercase; margin-bottom:8px; }
  .field input { width:100%; background:var(--bg); border:1px solid var(--border); border-radius:3px; color:var(--text); font-family:'DM Mono',monospace; font-size:14px; padding:12px 14px; outline:none; transition:border-color .2s,box-shadow .2s; }
  .field input:focus { border-color:var(--accent); box-shadow:0 0 0 3px rgba(200,240,96,.1); }
  .field input::placeholder { color:var(--muted); }

  .btn-login { width:100%; background:var(--accent); color:#0d0f0e; border:none; border-radius:3px; font-family:'Bebas Neue',sans-serif; font-size:20px; letter-spacing:.12em; padding:14px; cursor:pointer; margin-top:8px; transition:background .15s,transform .1s; }
  .btn-login:hover { background:#d6f575; }
  .btn-login:active { transform:scale(.98); }
  .btn-login:disabled { background:var(--muted); cursor:not-allowed; }

  .error-msg { display:none; margin-top:16px; padding:10px 14px; background:rgba(240,96,96,.1); border:1px solid rgba(240,96,96,.3); border-radius:3px; font-family:'DM Mono',monospace; font-size:12px; color:var(--danger); }
  .error-msg.show { display:block; }

  .footer-note { margin-top:20px; text-align:center; font-family:'DM Mono',monospace; font-size:11px; color:var(--muted); }
</style>
</head>
<body>
<div class="wrap">
  <div class="brand">
    <div class="brand-label">Admin Portal</div>
    <div class="brand-name">WARE<span>HOUSE</span></div>
  </div>
  <div class="card">
    <div class="card-title">// Authenticate</div>
    <div class="field">
      <label>Username</label>
      <input type="text" id="u" placeholder="admin" autocomplete="username">
    </div>
    <div class="field">
      <label>Password</label>
      <input type="password" id="p" placeholder="••••••••" autocomplete="current-password">
    </div>
    <button class="btn-login" id="loginBtn" onclick="login()">Sign In</button>
    <div class="error-msg" id="errMsg"></div>
  </div>
  <div class="footer-note">Warehouse Management System &mdash; v1.0</div>
</div>

<script>
const API = "http://localhost:3000";

const token = localStorage.getItem("wms_token");
if (token) {
  fetch(`${API}/verify`, { headers: { Authorization: `Bearer ${token}` } })
    .then(r => r.json()).then(d => { if (d.valid) location.href = "index.html"; }).catch(()=>{});
}

document.getElementById("p").addEventListener("keydown", e => { if (e.key === "Enter") login(); });

async function login() {
  const btn      = document.getElementById("loginBtn");
  const errMsg   = document.getElementById("errMsg");
  const username = document.getElementById("u").value.trim();
  const password = document.getElementById("p").value;
  errMsg.classList.remove("show");
  if (!username || !password) { showError("Please enter both username and password."); return; }
  btn.disabled = true; btn.textContent = "Signing In...";
  try {
    const r = await fetch(`${API}/login`, {
      method: "POST", headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password })
    });
    const d = await r.json();
    if (d.token) {
      localStorage.setItem("wms_token", d.token);
      localStorage.setItem("wms_user",  d.username);
      localStorage.setItem("wms_role",  d.role);
      location.href = "index.html";
    } else { showError(d.error || "Invalid credentials."); }
  } catch { showError("Cannot connect to server. Is the backend running?"); }
  btn.disabled = false; btn.textContent = "Sign In";
}

function showError(msg) {
  const el = document.getElementById("errMsg");
  el.textContent = msg; el.classList.add("show");
}
</script>
</body>
</html>
